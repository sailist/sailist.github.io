(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[235],{2405:function(e,s,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tutorial/cpp/4",function(){return l(6954)}])},6954:function(e,s,l){"use strict";l.r(s);var n=l(1527),r=l(6828),i=l(4579);function o(e){let s=Object.assign({h1:"h1",p:"p",h2:"h2",a:"a",h3:"h3",code:"code",pre:"pre",span:"span"},(0,i.ah)(),e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h1,{children:"构造"}),"\n",(0,n.jsx)(s.p,{children:"构造过程是数据的初始化过程，即在创造变量时的赋值过程。这个过程伴随着内存的申请/分配，分配在栈内存中的变量叫自动变量，生命周期由编译器控制，也叫静态构造过程（指需要的内存空间在编译过程确定，和 static 关键词的静态不是一个含义）；分配在堆内存中的变量叫非自动变量，生命周期由开发者控制，也叫动态构造过程（指空间在运行时确定）。"}),"\n",(0,n.jsx)(s.h2,{id:"静态构造",children:"静态构造"}),"\n",(0,n.jsxs)(s.p,{children:["基础数据类型、结构体、枚举、联合体的构造过程在 ",(0,n.jsx)(s.a,{href:"0.%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B",children:"0.数据类型.md"})," 中有过介绍。类通过类的各种构造函数完成初始化过程，见后。"]}),"\n",(0,n.jsx)(s.h2,{id:"动态构造",children:"动态构造"}),"\n",(0,n.jsx)(s.p,{children:"动态构造有两种方式：C 中的 malloc/free 系和 C++ 中的 new/delete 系。"}),"\n",(0,n.jsx)(s.h3,{id:"mallocfree",children:"malloc/free"}),"\n",(0,n.jsxs)(s.p,{children:["malloc/free 在 C 中定义在 ",(0,n.jsx)(s.code,{children:"<stdlib.h>"}),"，在 C++ 中定义在 ",(0,n.jsx)(s.code,{children:"<cstdlib>"}),"。"]}),"\n",(0,n.jsx)(s.pre,{"data-language":"c++","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"c++","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"#include <cstdlib>"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"int main(void)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    int *p1 = malloc(4*sizeof(int));  // allocates enough for an array of 4 int"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    int *p2 = malloc(sizeof(int[4])); // same, naming the type directly"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    int *p3 = malloc(4* sizeof *p3);   // same, without repeating the type name"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    if(p1) {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        for(int n=0; n<4; ++n) // populate the array"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            p1[n] = n*n;"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        for(int n=0; n<4; ++n) // print it back out"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'            printf("p1[%d] == %d\\n", n, p1[n]);'})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    free(p1);"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    free(p2);"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    free(p3);"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,n.jsx)(s.h3,{id:"newdelete",children:"new/delete"}),"\n",(0,n.jsx)(s.p,{children:"加 new 后"}),"\n",(0,n.jsx)(s.pre,{"data-language":"text","data-theme":"default",children:(0,n.jsx)(s.code,{"data-language":"text","data-theme":"default",children:(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})})})}),"\n",(0,n.jsx)(s.h3,{id:"一阶指针",children:"一阶指针"}),"\n",(0,n.jsx)(s.pre,{"data-language":"cpp","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"cpp","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"int"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" a "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"3"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"int"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"pa "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"&"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"a;"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"int"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"pb "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"int"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"5"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"int"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"pc "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" // 空指针"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"int"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"pd "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"int"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"pb);"})]})]})}),"\n",(0,n.jsx)(s.h3,{id:"二高阶指针",children:"二（高）阶指针"}),"\n",(0,n.jsx)(s.h3,{id:"类",children:"类"}),"\n",(0,n.jsx)(s.h1,{children:"析构"})]})}l(3366),s.default=(0,r.j)({MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,i.ah)(),e.components);return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(o,{...e})}):o(e)},pageOpts:{filePath:"pages/tutorial/cpp/4.md",route:"/tutorial/cpp/4",frontMatter:{authors:"sailist",date:"2022-11-05",description:"",draft:!1,title:"2.数据的构造和析构"},headings:[{depth:1,value:"构造",id:"构造"},{depth:2,value:"静态构造",id:"静态构造"},{depth:2,value:"动态构造",id:"动态构造"},{depth:3,value:"malloc/free",id:"mallocfree"},{depth:3,value:"new/delete",id:"newdelete"},{depth:3,value:"一阶指针",id:"一阶指针"},{depth:3,value:"二（高）阶指针",id:"二高阶指针"},{depth:3,value:"类",id:"类"},{depth:1,value:"析构",id:"析构"}],title:"2.数据的构造和析构"},pageNextRoute:"/tutorial/cpp/4"})}},function(e){e.O(0,[6828,9774,2888,179],function(){return e(e.s=2405)}),_N_E=e.O()}]);